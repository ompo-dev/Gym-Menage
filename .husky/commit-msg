#!/bin/sh

# Cores para output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[0;33m'
NC='\033[0m' # No Color

# ObtÃ©m a mensagem de commit do arquivo temporÃ¡rio
commit_msg_file=$1
commit_msg=$(cat "$commit_msg_file")

# PadrÃ£o para validar mensagens de commit (emoji + tipo + : + mensagem)
# Exemplos vÃ¡lidos:
# âœ¨ feat: adicionar nova funcionalidade
# ğŸ› fix: corrigir bug na autenticaÃ§Ã£o
# ğŸ“š docs: atualizar README
# :sparkles: feat: adicionar nova funcionalidade
pattern="^(ğŸ‰|âœ…|â¬†ï¸|â¬‡ï¸|â•|ğŸ‘Œ|ğŸ’«|ğŸ›|ğŸ’¡|ğŸ‰|ğŸ”§|ğŸš€|ğŸ“š|ğŸš§|ğŸ’„|ğŸ§±|ğŸ”œ|ğŸšš|âœ¨|ğŸ“¦|âš¡|â™»ï¸|ğŸ§¹|ğŸ—‘ï¸|â–|ğŸ“±|ğŸ’¥|ğŸ”’ï¸|ğŸ”ï¸|ğŸ”–|âœ”ï¸|ğŸ§ª|ğŸ“|ğŸ·ï¸|ğŸ¥…|ğŸ—ƒï¸|:[a-z_]+:) (feat|fix|docs|test|build|perf|style|refactor|chore|ci|raw|cleanup|remove)(\([a-z0-9-]+\))?:[[:space:]].{1,100}"

if ! echo "$commit_msg" | grep -qE "$pattern"; then
  echo "${RED}Erro: Mensagem de commit invÃ¡lida${NC}"
  echo "${YELLOW}A mensagem deve seguir o padrÃ£o: [emoji] [tipo]: [mensagem]${NC}"
  echo "${YELLOW}Exemplo: âœ¨ feat: adicionar pÃ¡gina de login${NC}"
  echo "${YELLOW}Ou: :sparkles: feat: adicionar pÃ¡gina de login${NC}"
  echo "\nTipos permitidos:"
  echo "  feat     - Novo recurso"
  echo "  fix      - CorreÃ§Ã£o de bug"
  echo "  docs     - DocumentaÃ§Ã£o"
  echo "  test     - Testes"
  echo "  build    - Build e dependÃªncias"
  echo "  perf     - Performance"
  echo "  style    - Estilo de cÃ³digo"
  echo "  refactor - RefatoraÃ§Ã£o"
  echo "  chore    - Tarefas gerais"
  echo "  ci       - IntegraÃ§Ã£o contÃ­nua"
  echo "  raw      - Dados e configuraÃ§Ãµes"
  echo "  cleanup  - Limpeza de cÃ³digo"
  echo "  remove   - RemoÃ§Ã£o de arquivos/recursos"
  echo "\nConsulte a documentaÃ§Ã£o para ver os emojis correspondentes a cada tipo."
  exit 1
fi

echo "${GREEN}Mensagem de commit vÃ¡lida!${NC}"
exit 0 